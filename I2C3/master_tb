#! /c/iverilog/bin/vvp
:ivl_version "0.9.6 " "(v0_9_6)";
:vpi_time_precision + 0;
:vpi_module "system";
:vpi_module "v2005_math";
:vpi_module "va_math";
S_002EA428 .scope module, "master" "master" 2 1;
 .timescale 0 0;
L_017814E8 .functor BUFZ 1, L_017A9C10, C4<0>, C4<0>, C4<0>;
v01771590_0 .var "ADC_read", 0 0;
v01784C20_0 .var "SCL", 0 0;
v002ED980_0 .net "SDA_rx", 0 0, L_017814E8; 1 drivers
v002ED9D8_0 .var "SDA_tx", 0 0;
v002EDA30_0 .net "SDL", 0 0, L_017A9C10; 1 drivers
v01782D00_0 .net *"_s0", 0 0, C4<z>; 0 drivers
v01782D58_0 .var "clk", 0 0;
v01782DB0_0 .var/i "i", 31 0;
v002E33F8_0 .var/i "j", 31 0;
v002E3450_0 .var "oe", 0 0;
v002E34A8_0 .var "start", 0 0;
v01772438_0 .var/i "state", 31 0;
E_01784390 .event posedge, v002E34A8_0;
E_01784370/0 .event negedge, v01782D58_0;
E_01784370/1 .event posedge, v01782D58_0;
E_01784370 .event/or E_01784370/0, E_01784370/1;
L_017A9C10 .functor MUXZ 1, C4<z>, v002ED9D8_0, v002E3450_0, C4<>;
S_002E9F60 .scope task, "write_slave" "write_slave" 2 72, 2 72, S_002EA428;
 .timescale 0 0;
v01784F30_0 .var "address", 7 0;
v002ED8D0_0 .var "data", 7 0;
E_01784350 .event posedge, v01782D58_0;
TD_master.write_slave ;
    %set/v v002ED9D8_0, 0, 1;
    %vpi_call 2 91 "$display", "START MASTER---state=%g, time=%g", v01772438_0, $time;
    %movi 8, 1, 32;
    %ix/load 0, 32, 0;
    %assign/v0 v01772438_0, 0, 8;
    %delay 600, 0;
    %ix/load 0, 1, 0;
    %assign/v0 v002E34A8_0, 0, 1;
    %movi 8, 7, 32;
    %set/v v01782DB0_0, 8, 32;
T_0.0 ;
    %load/v 8, v01782DB0_0, 32;
    %cmp/s 1, 8, 32;
    %or 5, 4, 1;
    %jmp/0xz T_0.1, 5;
    %wait E_01784350;
    %vpi_call 2 100 "$display", "Address %g bit %g", v01782DB0_0, $time;
    %ix/getv/s 1, v01782DB0_0;
    %jmp/1 T_0.2, 4;
    %load/x1p 8, v01784F30_0, 1;
    %jmp T_0.3;
T_0.2 ;
    %mov 8, 2, 1;
T_0.3 ;
; Save base=8 wid=1 in lookaside.
    %set/v v002ED9D8_0, 8, 1;
    %vpi_call 2 102 "$display", "Address %g bit sent=%b,%g", v01782DB0_0, &PV<v01784F30_0, v01782DB0_0, 1>, $time;
    %load/v 8, v01782DB0_0, 32;
    %cmp/u 8, 1, 32;
    %jmp/0xz  T_0.4, 4;
    %set/v v002E3450_0, 0, 1;
    %load/v 8, v002ED980_0, 1;
    %set/v v01771590_0, 8, 1;
    %vpi_call 2 108 "$display", "ACK Recieved=%b", v01771590_0, $time;
    %load/v 8, v01771590_0, 1;
    %mov 9, 0, 2;
    %cmpi/u 8, 1, 3;
    %jmp/0xz  T_0.6, 4;
    %vpi_call 2 111 "$display", "ACK Recieved";
T_0.6 ;
T_0.4 ;
    %load/v 8, v01782DB0_0, 32;
    %subi 8, 1, 32;
    %set/v v01782DB0_0, 8, 32;
    %jmp T_0.0;
T_0.1 ;
    %end;
S_002EA0F8 .scope module, "test_bench" "test_bench" 3 1;
 .timescale 0 0;
    .scope S_002EA428;
T_1 ;
    %vpi_call 2 26 "$display", "MASTER COMMUNICATING";
    %movi 8, 7, 32;
    %set/v v01782DB0_0, 8, 32;
    %movi 8, 7, 32;
    %set/v v002E33F8_0, 8, 32;
    %set/v v01782D58_0, 0, 1;
    %set/v v01772438_0, 0, 32;
    %set/v v002E34A8_0, 0, 1;
    %set/v v002E3450_0, 1, 1;
    %set/v v01784C20_0, 1, 1;
    %set/v v002ED9D8_0, 1, 1;
    %delay 1000, 0;
    %movi 8, 168, 8;
    %set/v v01784F30_0, 8, 8;
    %movi 8, 170, 8;
    %set/v v002ED8D0_0, 8, 8;
    %fork TD_master.write_slave, S_002E9F60;
    %join;
    %delay 100000, 0;
    %vpi_call 2 42 "$display", "START---oe=%g,start=%g,state=%g,i=%g,j=%g,time=%g", v002E3450_0, v002E34A8_0, v01772438_0, v01782DB0_0, v002E33F8_0, $time;
    %end;
    .thread T_1;
    .scope S_002EA428;
T_2 ;
    %wait E_01784370;
    %load/v 8, v01784C20_0, 1;
    %inv 8, 1;
    %set/v v01784C20_0, 8, 1;
    %jmp T_2;
    .thread T_2;
    .scope S_002EA428;
T_3 ;
    %wait E_01784390;
T_3.0 ;
    %load/v 8, v002E34A8_0, 1;
    %mov 9, 0, 2;
    %cmpi/u 8, 1, 3;
    %jmp/0xz T_3.1, 4;
    %set/v v01782D58_0, 1, 1;
    %delay 1300, 0;
    %set/v v01782D58_0, 0, 1;
    %delay 1200, 0;
    %jmp T_3.0;
T_3.1 ;
    %jmp T_3;
    .thread T_3;
    .scope S_002EA0F8;
T_4 ;
    %vpi_call 3 8 "$dumpfile", "master_tb.vcd";
    %vpi_call 3 9 "$dumpfile", 2'sb01;
    %vpi_call 3 10 "$display", "TESTBENCH RUNNING";
    %delay 200000, 0;
    %vpi_call 3 17 "$finish";
    %end;
    .thread T_4;
# The file index is used to find the file name in the following table.
:file_names 4;
    "N/A";
    "<interactive>";
    "design.v";
    "testbench.v";
